$(window).on("load",function(){$('img[data-plugin="pixelbrush"]').each(function(){void 0!==$(this).attr("data-autostart")&&$(this).attr("data-autostart")!==!1&&"true"===$(this).attr("data-autostart")&&$(this).pixelbrush()})}),function($){"use strict";var Pixelbrush=function(a,t){var o=this;if(o.$el=a,o.el=a[0],o.destroyed=!1,o.GUID=o.generateGUID(),o.options=$.extend({loop:!1,mode:"fade-in",ignore_class:"",interval:15,onComplete:function(){}},t),void 0!==o.$el.attr("data-loop")&&o.$el.attr("data-loop")!==!1&&("true"!==o.$el.attr("data-loop")&&"1"!==o.$el.attr("data-loop")||(o.options.loop=!0)),void 0!==o.$el.attr("data-ignore-class")&&o.$el.attr("data-ignore-class")!==!1&&(o.options.ignore_class=o.$el.attr("data-ignore-class")),void 0!==o.$el.attr("data-interval")&&o.$el.attr("data-interval")!==!1&&(o.options.interval=o.$el.attr("data-interval")),t=o.options,void 0!==o.$el.attr("data-mode")&&o.$el.attr("data-mode")!==!1)switch(o.$el.attr("data-mode")){case"fade-in":case"fade-out":case"focus":case"focus-in":case"unfocus":case"unfocus-out":case"bounce":o.options.mode=o.$el.attr("data-mode")}o.animation={width:o.$el.actual("width"),height:o.$el.actual("height"),canvas:{class:o.removeClassesToIgnore(" "+o.$el.attr("class")+" ",$.trim(o.options.ignore_class).split(" ")),brush:{el:null,context:null},palette:{el:null,context:null}},ratio:{current:null,start:null,high:1,low:.009},step:.95,opacity:1,first_loop:!0};var i=void 0!==o.$el.attr("style")&&o.$el.attr("style")!==!1?'style="'+o.$el.attr("style")+'" ':"";o.animation.canvas.brush.el=$("<canvas "+i+'class="'+o.animation.canvas.class+" pixelbrush-canvas-"+o.GUID+'" />').appendTo(o.$el.parent())[0],o.animation.canvas.brush.context=o.animation.canvas.brush.el.getContext("2d"),o.animation.canvas.palette.el=$("<canvas "+i+'class="'+o.animation.canvas.class+" pixelbrush-canvas-"+o.GUID+'" />')[0],o.animation.canvas.palette.context=o.animation.canvas.palette.el.getContext("2d"),o.init()};Pixelbrush.prototype.init=function(){var a=this;a.el.complete||void 0===a.el.complete?a.pixelate():a.$el.on("load",function(){a.pixelate()})},Pixelbrush.prototype.generateGUID=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},Pixelbrush.prototype.prefix=function(){var a=window.getComputedStyle(document.documentElement,""),t=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||""===a.OLink&&["","o"])[1];return{dom:"WebKit|Moz|MS|O".match(new RegExp("("+t+")","i"))[1],lowercase:t,css:"-"+t+"-",js:t[0].toUpperCase()+t.substr(1)}},Pixelbrush.prototype.cleanArray=function(a){var t=this;return $.each(a,function(o,i){if(""===$.trim(i))return a.splice(o,1),void t.cleanArray(a)}),a},Pixelbrush.prototype.removeClassesToIgnore=function(classes_string_to_modify,array_of_classes_to_ignore){var _this=this;return array_of_classes_to_ignore=_this.cleanArray(array_of_classes_to_ignore),$.each(array_of_classes_to_ignore,function(index,value){var regex=eval("/ "+value+" /gi");classes_string_to_modify=classes_string_to_modify.replace(regex,"")}),classes_string_to_modify},Pixelbrush.prototype.pixelate=function(){var a=this;if(!a.destroyed){switch("fade-in"!==a.options.mode&&a.$el.css("display","none"),$(a.animation.canvas.brush.el).css("display","inline-block"),a.animation.canvas.brush.el.width=a.animation.canvas.palette.el.width=a.animation.width,a.animation.canvas.brush.el.height=a.animation.canvas.palette.el.height=a.animation.height,void 0===a.animation.canvas.brush.context.imageSmoothingEnabled?(a.animation.canvas.brush.context[a.prefix().lowercase+"ImageSmoothingEnabled"]=!1,a.animation.canvas.palette.context[a.prefix().lowercase+"ImageSmoothingEnabled"]=!1):(a.animation.canvas.brush.context.imageSmoothingEnabled=!1,a.animation.canvas.palette.context.imageSmoothingEnabled=!1),a.options.mode){case"unfocus":case"fade-out":a.animation.ratio.low=.019;break;case"unfocus-out":case"focus-in":a.animation.ratio.low=1e-4;break;case"fade-in":a.animation.opacity=0;break;case"bounce":case"focus":}switch(a.options.mode){case"bounce":case"unfocus":case"unfocus-out":case"fade-out":a.animation.ratio.start=a.animation.ratio.high;break;case"focus":case"focus-in":case"fade-in":default:a.animation.ratio.start=a.animation.ratio.low}a.animation.ratio.current=a.animation.ratio.start,a.animate(a)}},Pixelbrush.prototype.gotoNextStep=function(){var a=this;a.animate(a)},Pixelbrush.prototype.animate=function(a){if(!a.destroyed){if(a.animation.ratio.current=a.animation.ratio.current*a.animation.step,a.animation.ratio.current>=a.animation.ratio.high){if(a.animation.ratio.current=a.animation.ratio.high,a.animation.step=.9,!a.options.loop){if("unfocus"!==a.options.mode){if($(a.animation.canvas.brush.el).css("position","absolute"),"fade-out"!==a.options.mode){var t=" "+a.$el.attr("class")+" ",o=$.trim(a.options.ignore_class).split(" ");a.$el.attr("class",a.removeClassesToIgnore(t,o)),a.$el.css("display","inline-block")}else a.$el.css({display:"inline-block",visibility:"hidden"});return $(a.animation.canvas.brush.el).remove(),$(a.animation.canvas.palette.el).remove(),void a.onComplete()}return void a.onComplete()}switch(a.animation.first_loop&&(a.onComplete(),a.animation.first_loop=!1),a.options.mode){case"fade-in":a.options.mode="fade-out";break;case"fade-out":a.options.mode="fade-in";break;case"focus":a.options.mode="unfocus";break;case"focus-in":a.options.mode="unfocus-out";break;case"unfocus":a.options.mode="focus";break;case"unfocus-out":a.options.mode="focus-in";break;case"bounce":}}switch(("unfocus"===a.options.mode&&a.animation.ratio.current>=a.animation.ratio.low||"unfocus"!==a.options.mode)&&(a.animation.canvas.palette.context.clearRect(0,0,a.animation.width,a.animation.height),a.animation.canvas.brush.context.clearRect(0,0,a.animation.width,a.animation.height)),a.options.mode){case"fade-out":$(a.animation.canvas.brush.el).css("opacity",a.animation.opacity),a.animation.opacity>0&&(a.animation.opacity-=.01);break;case"fade-in":$(a.animation.canvas.brush.el).css("opacity",a.animation.opacity),a.animation.opacity<1&&(a.animation.opacity+=.01)}if(a.animation.ratio.current<a.animation.ratio.low)if("focus"!==a.options.mode&&"focus-in"!==a.options.mode&&"fade-in"!==a.options.mode&&"bounce"!==a.options.mode||(a.animation.ratio.current=a.animation.ratio.low,a.animation.step=1.05),"unfocus-out"!==a.options.mode){if(1.05!==a.animation.step&&("unfocus"===a.options.mode||"fade-out"===a.options.mode)){if(!a.options.loop)return void a.onComplete();"unfocus"===a.options.mode?a.options.mode="focus":"fade-out"===a.options.mode&&(a.options.mode="fade-in")}}else if(a.animation.ratio.current<a.animation.ratio.low){if(!a.options.loop)return $(a.animation.canvas.brush.el).css("position","absolute"),a.$el.css({display:"inline-block",visibility:"hidden"}),$(a.animation.canvas.brush.el).remove(),$(a.animation.canvas.palette.el).remove(),void a.onComplete();a.animation.ratio.current=a.animation.ratio.low,a.animation.step=.95,a.options.mode="focus-in"}a.animation.canvas.palette.context.drawImage(a.el,0,0,a.animation.width*a.animation.ratio.current,a.animation.width*a.animation.ratio.current),a.animation.canvas.brush.context.drawImage(a.animation.canvas.palette.el,0,0,a.animation.width*a.animation.ratio.current,a.animation.width*a.animation.ratio.current,0,0,a.animation.width,a.animation.height),setTimeout(function(){a.gotoNextStep()},a.options.interval)}},Pixelbrush.prototype.destroy=function(){var a=this;$(".pixelbrush-canvas-"+a.GUID).remove(),a.$el.removeData("pixelbrush"),a.destroyed=!0},Pixelbrush.prototype.onComplete=function(){var a=this,t=null;void 0!==a.$el.attr("data-oncomplete")&&a.$el.attr("data-oncomplete")!==!1?t=$.trim(a.$el.attr("data-oncomplete")):(t=$.trim(a.options.onComplete.toString().match(/\{([\s\S]*)\}/m)[1]),t=$.trim(t.replace(/^\s*\/\/.*$/gm,""))),$.isEmptyObject(t)||$("head").append('<script type="text/javascript">$(function() { '+t+" });</script>")},$.newPlugin("pixelbrush",Pixelbrush)}(jQuery);